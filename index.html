<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>Voice Translator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#0B1220">

<style>
:root{
  --bg1:#0B1220;
  --bg2:#0E1B2E;
  --card: rgba(255,255,255,0.06);
  --stroke: rgba(255,255,255,0.14);
  --text: rgba(255,255,255,0.92);
  --muted: rgba(255,255,255,0.70);
  --accent:#7C3AED;
  --danger:#EF4444;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Tahoma,sans-serif;
  color:var(--text);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:18px;
  background:linear-gradient(135deg,var(--bg1),var(--bg2));
}
.wrap{width:100%;max-width:560px}
.card{
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:22px;
  padding:22px;
  text-align:center;
}
.grid,.btnRow{display:grid;grid-template-columns:1fr 1fr;gap:10px}
label{font-size:12px;color:var(--muted)}
select,textarea,button{
  width:100%;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(16,23,40,.65);
  color:var(--text);
  padding:12px;
  font-size:15px;
}
textarea{text-align:center;min-height:90px}
.box{
  min-height:60px;
  border-radius:16px;
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.12);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:12px;
  margin-top:10px;
}
.primary{background:linear-gradient(135deg,var(--accent),#A78BFA);color:#000}
.secondary{background:rgba(255,255,255,.06)}
.danger{background:rgba(239,68,68,.2)}
button{cursor:pointer;font-weight:700}
button:disabled{opacity:.5}
.hint{font-size:12px;color:var(--muted);margin-top:8px}
@media(max-width:420px){
  .grid,.btnRow{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="wrap">
<div class="card">

<h2>ğŸ™ Voice Translator</h2>

<div class="grid">
  <div>
    <label>Ø²Ø¨Ø§Ù† ÙˆØ±ÙˆØ¯ÛŒ</label>
    <select id="sourceLang"></select>
  </div>
  <div>
    <label>Ø²Ø¨Ø§Ù† Ù…Ù‚ØµØ¯</label>
    <select id="targetLang"></select>
  </div>
</div>

<div class="box" id="originalText">Ù…ØªÙ† ÙˆØ±ÙˆØ¯ÛŒâ€¦</div>
<div class="box" id="translatedText">ØªØ±Ø¬Ù…Ù‡â€¦</div>

<textarea id="manualInput" placeholder="Ù…ØªÙ† Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³â€¦"></textarea>

<div class="btnRow" style="margin-top:12px">
  <button id="recordBtn" class="primary">ğŸ™ Ø´Ø±ÙˆØ¹ ØµØ­Ø¨Øª</button>
  <button id="translateBtn" class="secondary">ğŸ” ØªØ±Ø¬Ù…Ù‡ Ù…ØªÙ†</button>
</div>

<div class="btnRow" style="margin-top:10px">
  <button id="playBtn" class="secondary" disabled>ğŸ”Š Ù¾Ø®Ø´ ØªØ±Ø¬Ù…Ù‡</button>
  <button id="stopBtn" class="secondary" disabled>â¹ ØªÙˆÙ‚Ù</button>
</div>

<!-- âœ… Ø¯Ú©Ù…Ù‡ Ø¬Ø¯ÛŒØ¯ -->
<div class="btnRow" style="margin-top:10px">
  <button id="clearTextBtn" class="danger">ğŸ§¹ Ù¾Ø§Ú©â€ŒÚ©Ø±Ø¯Ù† Ù…ØªÙ†â€ŒÙ‡Ø§</button>
</div>

<div class="hint" id="hint"></div>

</div>
</div>

<script>
const LANGS=[
 {n:"ÙØ§Ø±Ø³ÛŒ",sl:"fa-IR",tl:"fa"},
 {n:"English",sl:"en-US",tl:"en"},
 {n:"Deutsch",sl:"de-DE",tl:"de"},
 {n:"FranÃ§ais",sl:"fr-FR",tl:"fr"}
];

const s=document.getElementById("sourceLang");
const t=document.getElementById("targetLang");
const o=document.getElementById("originalText");
const tr=document.getElementById("translatedText");
const m=document.getElementById("manualInput");
const play=document.getElementById("playBtn");
const stop=document.getElementById("stopBtn");
const hint=document.getElementById("hint");

LANGS.forEach(l=>{
  s.add(new Option(l.n,l.sl));
  t.add(new Option(l.n,l.tl));
});
s.value="fa-IR"; t.value="en";

async function translateText(text,tl){
  const r=await fetch(
    `https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${tl}&dt=t&q=${encodeURIComponent(text)}`
  );
  const j=await r.json();
  return j?.[0]?.[0]?.[0] || "";
}

let last="";

async function runTranslate(text){
  if(!text.trim()){hint.textContent="Ù…ØªÙ† ÙˆØ§Ø±Ø¯ Ú©Ù†";return}
  hint.textContent="";
  o.textContent=text;
  m.value=text;

  const out=await translateText(text,t.value);
  tr.textContent=out;
  last=out;
  play.disabled=!out;
  stop.disabled=!out;
}

document.getElementById("translateBtn").onclick=()=>{
  runTranslate(m.value);
};

play.onclick=()=>{
  if(!last) return;
  const u=new SpeechSynthesisUtterance(last);
  u.lang=t.value;
  speechSynthesis.speak(u);
};

stop.onclick=()=>speechSynthesis.cancel();

const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
if(SR){
  const rec=new SR();
  rec.onresult=e=>{
    const text=e.results[0][0].transcript;
    runTranslate(text);
  };
  document.getElementById("recordBtn").onclick=()=>{
    rec.lang=s.value;
    rec.start();
  };
}

/* âœ… Ù¾Ø§Ú©â€ŒÚ©Ø±Ø¯Ù† ÙÙ‚Ø· Ù…ØªÙ†â€ŒÙ‡Ø§ (ØµØ¯Ø§ Ù‚Ø·Ø¹ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯) */
document.getElementById("clearTextBtn").onclick=()=>{
  o.textContent="Ù…ØªÙ† ÙˆØ±ÙˆØ¯ÛŒâ€¦";
  tr.textContent="ØªØ±Ø¬Ù…Ù‡â€¦";
  m.value="";
  last="";
  hint.textContent="";
};
</script>

</body>
</html>
