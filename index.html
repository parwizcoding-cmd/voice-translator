<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Voice Translator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#0B1220">

  <style>
    :root{
      --bg1:#0B1220;
      --bg2:#0E1B2E;
      --card: rgba(255,255,255,0.06);
      --stroke: rgba(255,255,255,0.14);
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.70);
      --accent:#7C3AED;
      --danger:#EF4444;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Segoe UI",Tahoma,sans-serif;
      color:var(--text);
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center;
      padding:18px;
      background:
        radial-gradient(900px 500px at 20% 15%, rgba(124,58,237,.35), transparent 55%),
        radial-gradient(900px 500px at 80% 20%, rgba(34,197,94,.25), transparent 55%),
        linear-gradient(135deg,var(--bg1),var(--bg2));
    }
    .wrap{width:100%;max-width:560px}
    .card{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:22px;
      padding:22px;
      box-shadow:0 25px 60px rgba(0,0,0,.45);
      backdrop-filter:blur(10px);
      text-align:center;
    }
    .topbar{
      display:grid;
      grid-template-columns:1fr auto 1fr;
      align-items:center;
      margin-bottom:10px;
    }
    .logoLeft{
      font-size:30px;
      font-weight:900;
      letter-spacing:2px;
      background:linear-gradient(135deg,#7C3AED,#22C55E);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    h1{margin:0;font-size:20px;font-weight:800}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
    label{font-size:12px;color:var(--muted);margin-bottom:6px;display:block}
    select,textarea,button{
      width:100%;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(16,23,40,.65);
      color:var(--text);
      padding:12px;
      font-size:15px;
    }
    .boxes{display:grid;gap:10px;margin-top:12px}
    .box{
      min-height:60px;
      border-radius:16px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:12px;
      text-align:center;
      word-break:break-word;
    }
    textarea{margin-top:10px;min-height:90px;resize:vertical;text-align:center}
    .btnRow{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
    button{cursor:pointer;font-weight:700}
    button:disabled{opacity:.55}
    .primary{background:linear-gradient(135deg,var(--accent),#A78BFA);color:#0B1220}
    .secondary{background:rgba(255,255,255,.06)}
    .danger{background:rgba(239,68,68,.18)}
    .hint{margin-top:10px;font-size:12px;color:var(--muted)}
    @media(max-width:420px){.grid,.btnRow{grid-template-columns:1fr}}
  </style>
</head>

<body>
<div class="wrap">
<div class="card">

  <div class="topbar">
    <div class="logoLeft">PZ</div>
    <h1>Voice Translator</h1>
    <div></div>
  </div>

  <div class="grid">
    <div>
      <label>Ø²Ø¨Ø§Ù† ÙˆØ±ÙˆØ¯ÛŒ</label>
      <select id="sourceLang"></select>
    </div>
    <div>
      <label>Ø²Ø¨Ø§Ù† Ù…Ù‚ØµØ¯</label>
      <select id="targetLang"></select>
    </div>
  </div>

  <div class="boxes">
    <div class="box" id="originalText">Ù…ØªÙ† ÙˆØ±ÙˆØ¯ÛŒâ€¦</div>
    <div class="box" id="translatedText">ØªØ±Ø¬Ù…Ù‡â€¦</div>
  </div>

  <textarea id="manualInput" placeholder="Ù…ØªÙ† Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³â€¦"></textarea>

  <div class="btnRow">
    <button id="recordBtn" class="primary">ğŸ™ Ø´Ø±ÙˆØ¹ ØµØ­Ø¨Øª</button>
    <button id="translateBtn" class="secondary">ğŸ” ØªØ±Ø¬Ù…Ù‡ Ù…ØªÙ†</button>
  </div>

  <div class="btnRow">
    <button id="playBtn" class="secondary" disabled>ğŸ”Š Ù¾Ø®Ø´ ØªØ±Ø¬Ù…Ù‡</button>
    <button id="stopBtn" class="danger" disabled>â¹ ØªÙˆÙ‚Ù ØµØ¯Ø§</button>
  </div>

  <div class="btnRow">
    <button id="clearTextBtn" class="danger">ğŸ§¹ Ù¾Ø§Ú©â€ŒÚ©Ø±Ø¯Ù† Ù…ØªÙ†â€ŒÙ‡Ø§</button>
  </div>

  <div class="hint" id="hintText"></div>

</div>
</div>

<script>
/* ğŸŒ LANGUAGES â€“ Ú©Ø§Ù…Ù„ */
const LANGS=[
 {n:"ÙØ§Ø±Ø³ÛŒ",tl:"fa",sl:"fa-IR",rtl:true},
 {n:"English",tl:"en",sl:"en-US"},
 {n:"FranÃ§ais",tl:"fr",sl:"fr-FR"},
 {n:"Deutsch",tl:"de",sl:"de-DE"},
 {n:"EspaÃ±ol",tl:"es",sl:"es-ES"},
 {n:"Italiano",tl:"it",sl:"it-IT"},
 {n:"PortuguÃªs",tl:"pt",sl:"pt-PT"},
 {n:"Ğ ÑƒÑÑĞºĞ¸Ğ¹",tl:"ru",sl:"ru-RU"},
 {n:"TÃ¼rkÃ§e",tl:"tr",sl:"tr-TR"},
 {n:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",tl:"ar",sl:"ar-SA",rtl:true},
 {n:"à¤¹à¤¿à¤¨à¥à¤¦à¥€",tl:"hi",sl:"hi-IN"},
 {n:"æ—¥æœ¬èª",tl:"ja",sl:"ja-JP"},
 {n:"í•œêµ­ì–´",tl:"ko",sl:"ko-KR"},
 {n:"ä¸­æ–‡",tl:"zh-CN",sl:"zh-CN"}
];

const s=sourceLang, t=targetLang;
const o=originalText, tr=translatedText, m=manualInput;
const play=playBtn, stop=stopBtn, hint=hintText;

LANGS.forEach(l=>{
  s.add(new Option(l.n,l.sl));
  t.add(new Option(l.n,l.tl));
});
s.value="fa-IR"; t.value="en";

/* ğŸ” TRANSLATE */
async function translateText(text,tl){
  const r=await fetch(
    `https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${tl}&dt=t&q=${encodeURIComponent(text)}`
  );
  const j=await r.json();
  return j?.[0]?.[0]?.[0] || "";
}

let last="";

/* ğŸ§  CENTRAL TRANSLATE */
async function runTranslate(text){
  if(!text.trim()) return;
  o.textContent=text;
  m.value=text;

  const out=await translateText(text,t.value);
  tr.textContent=out;
  last=out;
  play.disabled=!out;
  stop.disabled=!out;
}

/* âœï¸ MANUAL */
translateBtn.onclick=()=>runTranslate(m.value);

/* ğŸ”Š SPEAK */
play.onclick=()=>{
  if(!last) return;
  const u=new SpeechSynthesisUtterance(last);
  u.lang=t.value;
  speechSynthesis.speak(u);
};
stop.onclick=()=>speechSynthesis.cancel();

/* ğŸ™ VOICE â†’ AUTO TRANSLATE âœ… */
const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
if(SR){
  const rec=new SR();
  rec.continuous=false;
  rec.interimResults=false;

  rec.onresult=async(e)=>{
    const text=e.results?.[0]?.[0]?.transcript||"";
    await runTranslate(text); // ğŸ”¥ Ù…Ù‡Ù…
  };

  recordBtn.onclick=()=>{
    rec.lang=s.value;
    rec.start();
  };
}else{
  hint.textContent="Ù…Ø±ÙˆØ±Ú¯Ø± Ø§Ø² ØªØ´Ø®ÛŒØµ ØµØ¯Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯";
}

/* ğŸ§¹ CLEAR TEXT ONLY */
clearTextBtn.onclick=()=>{
  o.textContent="Ù…ØªÙ† ÙˆØ±ÙˆØ¯ÛŒâ€¦";
  tr.textContent="ØªØ±Ø¬Ù…Ù‡â€¦";
  m.value="";
  last="";
};
</script>
</body>
</html>
