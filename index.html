<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Voice Translator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#0b1220;
  font-family:tahoma;
  color:#fff;
}
.card{
  width:100%;
  max-width:520px;
  background:#111827;
  border-radius:18px;
  padding:18px;
  text-align:center;
}
.grid,.btnRow{display:grid;grid-template-columns:1fr 1fr;gap:10px}
label{font-size:12px;opacity:.7}
select,textarea,button{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  background:#1f2937;
  color:#fff;
}
textarea{text-align:center;min-height:80px}
.box{
  margin-top:10px;
  padding:14px;
  background:#1f2937;
  border-radius:14px;
  min-height:60px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.primary{background:#7c3aed;color:#000;font-weight:700}
.secondary{background:#374151}
.danger{background:#dc2626}
button{cursor:pointer}
button:disabled{opacity:.5}
.hint{font-size:12px;opacity:.7;margin-top:8px}
@media(max-width:420px){
  .grid,.btnRow{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="card">

<h2>ğŸ™ Voice Translator</h2>

<div class="grid">
  <div>
    <label>Ø²Ø¨Ø§Ù† ÙˆØ±ÙˆØ¯ÛŒ</label>
    <select id="sourceLang"></select>
  </div>
  <div>
    <label>Ø²Ø¨Ø§Ù† Ù…Ù‚ØµØ¯</label>
    <select id="targetLang"></select>
  </div>
</div>

<div class="box" id="originalText">Ù…ØªÙ† ÙˆØ±ÙˆØ¯ÛŒâ€¦</div>
<div class="box" id="translatedText">ØªØ±Ø¬Ù…Ù‡â€¦</div>

<textarea id="manualInput" placeholder="Ù…ØªÙ† Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³â€¦"></textarea>

<div class="btnRow" style="margin-top:10px">
  <button id="recordBtn" class="primary">ğŸ™ Ø´Ø±ÙˆØ¹ ØµØ­Ø¨Øª</button>
  <button id="translateBtn" class="secondary">ğŸ” ØªØ±Ø¬Ù…Ù‡ Ù…ØªÙ†</button>
</div>

<div class="btnRow" style="margin-top:10px">
  <button id="playBtn" class="secondary" disabled>ğŸ”Š Ù¾Ø®Ø´ ØªØ±Ø¬Ù…Ù‡</button>
  <button id="stopBtn" class="secondary" disabled>â¹ ØªÙˆÙ‚Ù</button>
</div>

<div class="btnRow" style="margin-top:10px">
  <button id="clearAllBtn" class="danger">ğŸ§¹ Ù¾Ø§Ú©â€ŒÚ©Ø±Ø¯Ù† Ù…ØªÙ†â€ŒÙ‡Ø§</button>
</div>

<div class="hint" id="hint"></div>

</div>

<script>
const LANGS=[
 {n:"ÙØ§Ø±Ø³ÛŒ",sl:"fa-IR",tl:"fa"},
 {n:"English",sl:"en-US",tl:"en"},
 {n:"Deutsch",sl:"de-DE",tl:"de"},
 {n:"FranÃ§ais",sl:"fr-FR",tl:"fr"}
];

const s=document.getElementById("sourceLang");
const t=document.getElementById("targetLang");
const o=document.getElementById("originalText");
const tr=document.getElementById("translatedText");
const m=document.getElementById("manualInput");
const play=document.getElementById("playBtn");
const stop=document.getElementById("stopBtn");
const hint=document.getElementById("hint");

LANGS.forEach(l=>{
  s.add(new Option(l.n,l.sl));
  t.add(new Option(l.n,l.tl));
});
s.value="fa-IR"; t.value="en";

async function translateText(text,tl){
  const r=await fetch(
    `https://translate.googleapis.com/translate_a/single?client=gtx&sl=auto&tl=${tl}&dt=t&q=${encodeURIComponent(text)}`
  );
  const j=await r.json();
  return j?.[0]?.[0]?.[0] || "";
}

let last="";

async function runTranslate(text){
  if(!text.trim()){hint.textContent="Ù…ØªÙ† ÙˆØ§Ø±Ø¯ Ú©Ù†";return}
  hint.textContent="";
  o.textContent=text;
  m.value=text;

  const out=await translateText(text,t.value);
  tr.textContent=out;
  last=out;
  play.disabled=!out;
  stop.disabled=!out;
}

document.getElementById("translateBtn").onclick=()=>{
  runTranslate(m.value);
};

play.onclick=()=>{
  if(!last) return;
  const u=new SpeechSynthesisUtterance(last);
  u.lang=t.value;
  speechSynthesis.speak(u);
};

stop.onclick=()=>{
  speechSynthesis.cancel();
};

const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
if(SR){
  const rec=new SR();
  rec.onresult=e=>{
    const text=e.results[0][0].transcript;
    runTranslate(text);
  };
  document.getElementById("recordBtn").onclick=()=>{
    rec.lang=s.value;
    rec.start();
  };
}

/* ğŸ§¹ Ù¾Ø§Ú©â€ŒÚ©Ø±Ø¯Ù† ÙÙ‚Ø· Ù…ØªÙ†â€ŒÙ‡Ø§ (Ø¨Ø¯ÙˆÙ† Ù‚Ø·Ø¹ ØµØ¯Ø§) */
document.getElementById("clearAllBtn").onclick=()=>{
  o.textContent="Ù…ØªÙ† ÙˆØ±ÙˆØ¯ÛŒâ€¦";
  tr.textContent="ØªØ±Ø¬Ù…Ù‡â€¦";
  m.value="";
  last="";
  hint.textContent="";
};
</script>
</body>
</html>
